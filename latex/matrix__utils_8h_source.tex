\doxysection{matrix\+\_\+utils.\+h}
\hypertarget{matrix__utils_8h_source}{}\label{matrix__utils_8h_source}\index{include/math/matrix\_utils.h@{include/math/matrix\_utils.h}}
\mbox{\hyperlink{matrix__utils_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Matrix_8h}{Matrix.h}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00017\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_ace948cba52caa75f48454f881bc51a68}{HadamardMulti}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ lhs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ rhs)\ \{}
\DoxyCodeLine{00018\ \ \ lhs.\mbox{\hyperlink{classMatrix_a7ff3adb55a7fcd61963647884d97cbd1}{assertSize}}(rhs);}
\DoxyCodeLine{00019\ \ \ \textcolor{keyword}{auto}\ result\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(),\ lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00020\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ result.rows();\ i++)\ \{}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ result.columns();\ j++)\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ result.elements();\ elem++)\ \{\ result(i,\ j,\ elem)\ =\ lhs(i,\ j,\ elem)\ *\ rhs(i,\ j,\ elem);\ \}}
\DoxyCodeLine{00023\ \ \ \ \ \}}
\DoxyCodeLine{00024\ \ \ \}}
\DoxyCodeLine{00025\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00026\ \}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00036\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_aaa7678f560359b32faa3d233e7788f3d}{HadamardDiv}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ lhs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ rhs)\ \{}
\DoxyCodeLine{00037\ \ \ lhs.\mbox{\hyperlink{classMatrix_a7ff3adb55a7fcd61963647884d97cbd1}{assertSize}}(rhs);}
\DoxyCodeLine{00038\ \ \ \textcolor{keyword}{auto}\ result\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(),\ lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00039\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ result.rows();\ i++)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ result.columns();\ j++)\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ result.elements();\ elem++)\ \{\ result(i,\ j,\ elem)\ =\ lhs(i,\ j,\ elem)\ /\ rhs(i,\ j,\ elem);\ \}}
\DoxyCodeLine{00042\ \ \ \ \ \}}
\DoxyCodeLine{00043\ \ \ \}}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00045\ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00056\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_a93aa2d642177c606086b7ed35dbd634c}{KroneckerMulti}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ lhs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ rhs)\ \{}
\DoxyCodeLine{00057\ \ \ assert(lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}()\ ==\ rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00058\ \ \ \textcolor{keyword}{auto}\ result\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ *\ rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ *\ rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(),\ rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ m\ =\ 0;\ m\ <\ lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ m++)\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ n\ =\ 0;\ n\ <\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ n++)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ p++)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ q\ =\ 0;\ q\ <\ rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ q++)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ elem++)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ result(m\ *\ rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ +\ p,\ n\ *\ rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ +\ q,\ elem)\ =\ lhs(m,\ n,\ elem)\ *\ rhs(p,\ q,\ elem);}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \}}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00080\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00081\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_a1f9177b021b6f3a2ec3a4f0b26797b8e}{HorizontalConcat}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ lhs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ rhs)\ \{}
\DoxyCodeLine{00082\ \ \ assert(lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ ==\ rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());}
\DoxyCodeLine{00083\ \ \ assert(lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}()\ ==\ rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00084\ \ \ \textcolor{keyword}{auto}\ result\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0.0,\ lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ +\ rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(),\ lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ ++i)\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ +\ rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ ++j)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ ++elem)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ result(i,\ j,\ elem)\ =\ j\ <\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ ?\ lhs(i,\ j,\ elem)\ :\ rhs(i,\ j\ -\/\ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(),\ elem);}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \ \ \}}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00093\ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00102\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00103\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{matrix__utils_8h_a0a35c20e3d36bb16e1ae7e4dbaae29ce}{Corr}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ B)\ \{}
\DoxyCodeLine{00104\ \ \ A.\mbox{\hyperlink{classMatrix_a7ff3adb55a7fcd61963647884d97cbd1}{assertSize}}(B);}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordtype}{size\_t}\ count\ =\ 0;}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ A.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ A.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ A.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ elem++)\ \{\ count\ +=\ (A(i,\ j,\ elem)\ ==\ B(i,\ j,\ elem));\ \}}
\DoxyCodeLine{00109\ \ \ \ \ \}}
\DoxyCodeLine{00110\ \ \ \}}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{return}\ count;}
\DoxyCodeLine{00112\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00121\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00122\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_abcd4628e1dd87e594aa69c1e9e60cd19}{from\_vptr}}(\textcolor{keyword}{const}\ T*\ value,\ \mbox{\hyperlink{structMatrixDimension}{MatrixDimension}}\ size)\ \{}
\DoxyCodeLine{00123\ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ size.\mbox{\hyperlink{structMatrixDimension_a93df531cf74c1c3a6d6c0519cb2789ef}{rows}},\ size.\mbox{\hyperlink{structMatrixDimension_aef50c3f8f188346f84c30f0dae35436d}{columns}});}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ size.\mbox{\hyperlink{structMatrixDimension_a93df531cf74c1c3a6d6c0519cb2789ef}{rows}};\ i++)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ size.\mbox{\hyperlink{structMatrixDimension_aef50c3f8f188346f84c30f0dae35436d}{columns}};\ j++)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ size.\mbox{\hyperlink{structMatrixDimension_a1f5be55c8a60262ddb045e4d3f4310e1}{elemDim}};\ elem++)\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ out(i,\ j,\ elem)\ =\ value[elem\ +\ j\ *\ size.\mbox{\hyperlink{structMatrixDimension_a1f5be55c8a60262ddb045e4d3f4310e1}{elemDim}}\ +\ i\ *\ size.\mbox{\hyperlink{structMatrixDimension_aef50c3f8f188346f84c30f0dae35436d}{columns}}\ *\ size.\mbox{\hyperlink{structMatrixDimension_a1f5be55c8a60262ddb045e4d3f4310e1}{elemDim}}];}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \}}
\DoxyCodeLine{00131\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00142\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00143\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{matrix__utils_8h_a2a01e8ac881ea58d279cd73ec1803444}{argmax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat)\ \{}
\DoxyCodeLine{00144\ \ \ T\ maxVal\ \ \ \ \ \ \ \ =\ std::numeric\_limits<T>::min();}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordtype}{size\_t}\ maxIndex\ =\ -\/1;}
\DoxyCodeLine{00146\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ elem++)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mat(i,\ j,\ elem)\ >\ maxVal)\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ maxVal\ \ \ =\ mat(i,\ j,\ elem);}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ maxIndex\ =\ elem\ +\ j\ *\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}()\ +\ i\ *\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ *\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \}}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{return}\ maxIndex;}
\DoxyCodeLine{00157\ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00166\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00167\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{matrix__utils_8h_a14c028e4d81577bbda70dd22db04afe8}{argmin}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat)\ \{}
\DoxyCodeLine{00168\ \ \ T\ maxVal\ \ \ \ \ \ \ \ =\ std::numeric\_limits<T>::max();}
\DoxyCodeLine{00169\ \ \ \textcolor{keywordtype}{size\_t}\ maxIndex\ =\ -\/1;}
\DoxyCodeLine{00170\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ ++elem)\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mat(i,\ j,\ elem)\ <\ maxVal)\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ maxVal\ \ \ =\ mat(i,\ j,\ elem);}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ maxIndex\ =\ elem\ +\ j\ *\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}()\ +\ i\ *\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ *\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00178\ \ \ \ \ \}}
\DoxyCodeLine{00179\ \ \ \}}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{return}\ maxIndex;}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00193\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00194\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_afb3f7de2743f10b710460feb9c0f9009}{where}}(}
\DoxyCodeLine{00195\ \textcolor{keyword}{const}\ std::function<\textcolor{keywordtype}{bool}(T)>\&\ condition,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ in,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ valIfTrue,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ valIfFalse)\ \{}
\DoxyCodeLine{00196\ \ \ assert(valIfTrue.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ ==\ valIfFalse.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ \&\&\ valIfTrue.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ ==\ valIfFalse.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());}
\DoxyCodeLine{00197\ \ \ \textcolor{keywordtype}{bool}\ refVector\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00198\ \ \ \textcolor{keywordflow}{if}((valIfTrue.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ ==\ valIfTrue.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}())\ ==\ 1)\ \{\ refVector\ =\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00199\ \ \ \textcolor{keyword}{auto}\ out\ =\ refVector\ ?\ valIfTrue\ :\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(),\ in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ elem++)\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(refVector)\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!condition(in(i,\ j,\ elem)))\ out(i,\ j,\ elem)\ =\ valIfFalse(i,\ j);}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ out(i,\ j,\ elem)\ =\ in(i,\ j,\ elem);}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ out(i,\ j,\ elem)\ =\ condition(in(i,\ j,\ elem))\ ?\ valIfTrue(0,\ 0)\ :\ valIfFalse(0,\ 0);}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ \}}
\DoxyCodeLine{00213\ \ \ \}}
\DoxyCodeLine{00214\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00215\ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00224\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00225\ \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}}\ \mbox{\hyperlink{matrix__utils_8h_ae294329feebecaabb007edfe6a36d830}{where\_value}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ in,\ T\ value)\ \{}
\DoxyCodeLine{00226\ \ \ assert(in.\mbox{\hyperlink{classMatrix_afae3fd51682a7d647fc87702252ceff3}{IsVector}}());}
\DoxyCodeLine{00227\ \ \ \textcolor{keywordtype}{bool}\ requires\_transposition\ =\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ <\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();}
\DoxyCodeLine{00228\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}}\ out\ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}}(0,\ !requires\_transposition\ ?\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ :\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(),\ 1);}
\DoxyCodeLine{00229\ \ \ \textcolor{keywordtype}{size\_t}\ found\_vals\ \ \ \ \ \ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{00230\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ (!requires\_transposition\ ?\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ :\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());\ ++i)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordflow}{if}(in(requires\_transposition\ ?\ 0\ :\ i,\ requires\_transposition\ ?\ i\ :\ 0)\ ==\ value)\ \{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ out(found\_vals,\ 0)\ =\ i;}
\DoxyCodeLine{00233\ \ \ \ \ \ \ found\_vals++;}
\DoxyCodeLine{00234\ \ \ \ \ \}}
\DoxyCodeLine{00235\ \ \ \}}
\DoxyCodeLine{00236\ \ \ \textcolor{keywordflow}{return}\ requires\_transposition\ ?\ out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ found\_vals\ -\/\ 1).\mbox{\hyperlink{classMatrix_a054a03bcae4eb86d6f4ef84dc87840ef}{Transpose}}()\ :\ out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ found\_vals\ -\/\ 1);}
\DoxyCodeLine{00237\ \}}
\DoxyCodeLine{00245\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00246\ \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}}\ \mbox{\hyperlink{matrix__utils_8h_a06d4149d83f11dbd6ae1ea8a51cdfa12}{where\_true}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ in)\ \{}
\DoxyCodeLine{00247\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{matrix__utils_8h_ae294329feebecaabb007edfe6a36d830}{where\_value}}(in,\ 1.0);}
\DoxyCodeLine{00248\ \}}
\DoxyCodeLine{00256\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00257\ \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}}\ \mbox{\hyperlink{matrix__utils_8h_ad9e4f7e23e67730cd255288face8d8d3}{where\_false}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ in)\ \{}
\DoxyCodeLine{00258\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{matrix__utils_8h_ae294329feebecaabb007edfe6a36d830}{where\_value}}(in,\ 0.0);}
\DoxyCodeLine{00259\ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00270\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00271\ std::vector<std::pair<Matrix<T>,\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}>>\ \mbox{\hyperlink{matrix__utils_8h_a98433477e0327bd2ee165374375275e1}{zip}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ b)\ \{}
\DoxyCodeLine{00272\ \ \ std::vector<std::pair<Matrix<T>,\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}>>\ out(a.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ a.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ subA,\ subB;}
\DoxyCodeLine{00275\ \ \ \ \ subA.\mbox{\hyperlink{classMatrix_a9483215681a238c3da0e385c3a31fe16}{Resize}}(1,\ a.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00276\ \ \ \ \ subB.\mbox{\hyperlink{classMatrix_a9483215681a238c3da0e385c3a31fe16}{Resize}}(1,\ b.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ a.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{\ subA(0,\ j)\ =\ a(i,\ j);\ \}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ b.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{\ subB(0,\ j)\ =\ b(i,\ j);\ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ out[i]\ =\ \{\ subA,\ subB\ \};}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00283\ \}}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00291\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00292\ T\ \mbox{\hyperlink{matrix__utils_8h_a8dd66fbac5097923b2ecf481b0ae77e5}{max}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat)\ \{}
\DoxyCodeLine{00293\ \ \ T\ maxVal\ =\ std::numeric\_limits<T>::min();}
\DoxyCodeLine{00294\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ k\ =\ 0;\ k\ <\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ k++)\ \{}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mat(i,\ j,\ k)\ >\ maxVal)\ \{\ maxVal\ =\ mat(i,\ j,\ k);\ \}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00299\ \ \ \ \ \}}
\DoxyCodeLine{00300\ \ \ \}}
\DoxyCodeLine{00301\ \ \ \textcolor{keywordflow}{return}\ maxVal;}
\DoxyCodeLine{00302\ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00306\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_a8dd66fbac5097923b2ecf481b0ae77e5}{max}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat,\ \textcolor{keywordtype}{int}\ axis)\ \{}
\DoxyCodeLine{00307\ \ \ \textcolor{keywordtype}{bool}\ row\_wise\ =\ axis\ ==\ 0;}
\DoxyCodeLine{00308\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ out\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ row\_wise\ ?\ 1\ :\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ :\ 1);}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ (row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ :\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());\ i++)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ out(row\_wise\ ?\ 0\ :\ i,\ row\_wise\ ?\ i\ :\ 0)\ =\ \mbox{\hyperlink{matrix__utils_8h_adf917f83162312bfe4a7a861c6f0cbcb}{elemMax}}(}
\DoxyCodeLine{00312\ \ \ \ \ mat.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise\ ?\ 0\ :\ i,\ row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1\ :\ i,\ row\_wise\ ?\ i\ :\ 0,\ row\_wise\ ?\ i\ :\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1),}
\DoxyCodeLine{00313\ \ \ \ \ 0);}
\DoxyCodeLine{00314\ \ \ \}}
\DoxyCodeLine{00315\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00316\ \}}
\DoxyCodeLine{00323\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00324\ T\ \mbox{\hyperlink{matrix__utils_8h_a4bb73e4029612f323f406f1ecfc2ed57}{min}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat)\ \{}
\DoxyCodeLine{00325\ \ \ T\ minVal\ =\ std::numeric\_limits<T>::max();}
\DoxyCodeLine{00326\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ k\ =\ 0;\ k\ <\ mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ k++)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mat(i,\ j,\ k)\ <\ minVal)\ \{\ minVal\ =\ mat(i,\ j,\ k);\ \}}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00331\ \ \ \ \ \}}
\DoxyCodeLine{00332\ \ \ \}}
\DoxyCodeLine{00333\ \ \ \textcolor{keywordflow}{return}\ minVal;}
\DoxyCodeLine{00334\ \}}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00336\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00337\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_a4bb73e4029612f323f406f1ecfc2ed57}{min}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat,\ \textcolor{keywordtype}{int}\ axis)\ \{}
\DoxyCodeLine{00338\ \ \ \textcolor{keywordtype}{bool}\ row\_wise\ =\ axis\ ==\ 0;}
\DoxyCodeLine{00339\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ out\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ row\_wise\ ?\ 1\ :\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ :\ 1);}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ (row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ :\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());\ i++)\ \{}
\DoxyCodeLine{00342\ \ \ \ \ out(row\_wise\ ?\ 0\ :\ i,\ row\_wise\ ?\ i\ :\ 0)\ =\ \mbox{\hyperlink{matrix__utils_8h_a45d36755afc757808fcf8e6dc7a2c063}{elemMin}}(}
\DoxyCodeLine{00343\ \ \ \ \ mat.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise\ ?\ 0\ :\ i,\ row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1\ :\ i,\ row\_wise\ ?\ i\ :\ 0,\ row\_wise\ ?\ i\ :\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1),}
\DoxyCodeLine{00344\ \ \ \ \ 0);}
\DoxyCodeLine{00345\ \ \ \}}
\DoxyCodeLine{00346\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00347\ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00357\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00358\ T\ \mbox{\hyperlink{matrix__utils_8h_adf917f83162312bfe4a7a861c6f0cbcb}{elemMax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\&\ elemIndex)\ \{}
\DoxyCodeLine{00359\ \ \ assert(mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}()\ -\/\ 1\ >=\ elemIndex);}
\DoxyCodeLine{00360\ \ \ T\ maxVal\ \ \ \ \ =\ std::numeric\_limits<T>::min();}
\DoxyCodeLine{00361\ \ \ \textcolor{keywordtype}{size\_t}\ index\ =\ 0;}
\DoxyCodeLine{00362\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mat(i,\ j,\ elemIndex)\ >\ maxVal)\ \{\ maxVal\ =\ mat(i,\ j,\ elemIndex);\ \}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ index++;}
\DoxyCodeLine{00366\ \ \ \ \ \}}
\DoxyCodeLine{00367\ \ \ \}}
\DoxyCodeLine{00368\ \ \ \textcolor{keywordflow}{return}\ maxVal;}
\DoxyCodeLine{00369\ \}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00378\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00379\ T\ \mbox{\hyperlink{matrix__utils_8h_a45d36755afc757808fcf8e6dc7a2c063}{elemMin}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\&\ elemIndex)\ \{}
\DoxyCodeLine{00380\ \ \ assert(mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}()\ -\/\ 1\ >=\ elemIndex);}
\DoxyCodeLine{00381\ \ \ T\ maxVal\ \ \ \ \ =\ std::numeric\_limits<T>::max();}
\DoxyCodeLine{00382\ \ \ \textcolor{keywordtype}{size\_t}\ index\ =\ 0;}
\DoxyCodeLine{00383\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mat(i,\ j,\ elemIndex)\ <\ maxVal)\ \{\ maxVal\ =\ mat(i,\ j,\ elemIndex);\ \}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ index++;}
\DoxyCodeLine{00387\ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \}}
\DoxyCodeLine{00389\ \ \ \textcolor{keywordflow}{return}\ maxVal;}
\DoxyCodeLine{00390\ \}}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00400\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00401\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_a23bb7f728122a09c240223a4de6730a9}{mean}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat,\ \textcolor{keywordtype}{int}\ axis\ =\ -\/1)\ \{}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{if}(axis\ ==\ -\/1)\ \{}
\DoxyCodeLine{00403\ \ \ \ \ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ sum\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ 1,\ 1);}
\DoxyCodeLine{00404\ \ \ \ \ T\ index\ \ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ sum(0,\ 0)\ +=\ mat(i,\ j);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ index++;}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00410\ \ \ \ \ \}}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordflow}{return}\ (1.0\ /\ index)\ *\ sum;}
\DoxyCodeLine{00412\ \ \ \}}
\DoxyCodeLine{00413\ \ \ \textcolor{keywordtype}{bool}\ row\_wise\ =\ axis\ ==\ 0;}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ sum\ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ row\_wise\ ?\ 1\ :\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ :\ 1);}
\DoxyCodeLine{00416\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ (row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ :\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());\ i++)\ \{}
\DoxyCodeLine{00417\ \ \ \ \ sum\ +=}
\DoxyCodeLine{00418\ \ \ \ \ mat.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise\ ?\ i\ :\ 0,\ row\_wise\ ?\ i\ :\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ row\_wise\ ?\ 0\ :\ i,\ row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1\ :\ i);}
\DoxyCodeLine{00419\ \ \ \}}
\DoxyCodeLine{00420\ \ \ \textcolor{keywordflow}{return}\ (1.0\ /\ (row\_wise\ ?\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ :\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()))\ *\ sum;}
\DoxyCodeLine{00421\ \}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00430\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00431\ T\ \mbox{\hyperlink{matrix__utils_8h_aaad7330b0e1e9c27b308a224210a14f9}{elemMean}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ mat,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\&\ elemIndex)\ \{}
\DoxyCodeLine{00432\ \ \ assert(mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}()\ -\/\ 1\ >=\ elemIndex);}
\DoxyCodeLine{00433\ \ \ T\ sum(0);}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordtype}{size\_t}\ index\ =\ 0;}
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();\ j++)\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ sum\ +=\ mat(i,\ j,\ elemIndex);}
\DoxyCodeLine{00438\ \ \ \ \ \ \ index++;}
\DoxyCodeLine{00439\ \ \ \ \ \}}
\DoxyCodeLine{00440\ \ \ \}}
\DoxyCodeLine{00441\ \ \ \textcolor{keywordflow}{return}\ sum\ /\ index;}
\DoxyCodeLine{00442\ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00450\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00451\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_a2e19f18bb0d422da0e75d5d0f6753331}{diag\_elements}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ in)\ \{}
\DoxyCodeLine{00452\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ out(0,\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ 1,\ in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{00453\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ i++)\ \{}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ elem\ =\ 0;\ elem\ <\ in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();\ elem++)\ \{\ out(i,\ 0,\ elem)\ =\ in(i,\ i,\ elem);\ \}}
\DoxyCodeLine{00455\ \ \ \}}
\DoxyCodeLine{00456\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00457\ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00465\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00466\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ \mbox{\hyperlink{matrix__utils_8h_af79386365c3901ef0bec8f116368ded2}{unique}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\&\ in,\ [[maybe\_unused]]\ \textcolor{keywordtype}{int}\ axis\ =\ 0)\ \{}
\DoxyCodeLine{00467\ \ \ \textcolor{keywordtype}{bool}\ row\_wise\ \ \ \ \ =\ axis\ ==\ 0;}
\DoxyCodeLine{00468\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<T>}}\ out\ \ \ \ \ =\ \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0,\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00469\ \ \ \textcolor{keywordtype}{size\_t}\ found\_vals\ =\ 0;}
\DoxyCodeLine{00470\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ (row\_wise\ ?\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ :\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());\ ++i)\ \{}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordtype}{bool}\ found\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keyword}{auto}\ xi\ =}
\DoxyCodeLine{00473\ \ \ \ \ in.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise\ ?\ i\ :\ 0,\ row\_wise\ ?\ i\ :\ in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ row\_wise\ ?\ 0\ :\ i,\ row\_wise\ ?\ in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1\ :\ i);}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ found\_vals;\ ++j)\ \{}
\DoxyCodeLine{00475\ \ \ \ \ \ \ found\ =\ xi}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ==\ out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ row\_wise\ ?\ j\ :\ 0,\ row\_wise\ ?\ j\ :\ out.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ row\_wise\ ?\ 0\ :\ j,\ row\_wise\ ?\ out.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1\ :\ j);}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(found)\ \{\ \textcolor{keywordflow}{break};\ \}}
\DoxyCodeLine{00479\ \ \ \ \ \}}
\DoxyCodeLine{00480\ \ \ \ \ \textcolor{keywordflow}{if}(!found)\ \{}
\DoxyCodeLine{00481\ \ \ \ \ \ \ out.\mbox{\hyperlink{classMatrix_a15c969e68b5492a3e9918a001ba8beb2}{SetSlice}}(found\_vals,\ xi);}
\DoxyCodeLine{00482\ \ \ \ \ \ \ found\_vals++;}
\DoxyCodeLine{00483\ \ \ \ \ \}}
\DoxyCodeLine{00484\ \ \ \}}
\DoxyCodeLine{00485\ \ \ \textcolor{keywordflow}{return}\ out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ found\_vals\ -\/\ 1);}
\DoxyCodeLine{00486\ \}}

\end{DoxyCode}
