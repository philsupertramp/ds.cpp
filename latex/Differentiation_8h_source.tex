\doxysection{Differentiation.\+h}
\hypertarget{Differentiation_8h_source}{}\label{Differentiation_8h_source}\index{include/math/numerics/analysis/Differentiation.h@{include/math/numerics/analysis/Differentiation.h}}
\mbox{\hyperlink{Differentiation_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Matrix_8h}{../../Matrix.h}}"{}}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{matrix__utils_8h}{../../matrix\_utils.h}}"{}}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{numerics_2utils_8h}{../utils.h}}"{}}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00053\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\ \mbox{\hyperlink{Differentiation_8h_a03b7286d06d466aedafd5fe7e2fcb636}{forwardDiff}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ y)\ \{}
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{auto}\ df\ \ =\ \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{auto}\ dy\ \ =\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(1,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1)\ -\/\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 2,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00056\ \ \ \textcolor{keyword}{auto}\ dx\ \ =\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(1,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1)\ -\/\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 2,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{auto}\ res\ =\ \mbox{\hyperlink{matrix__utils_8h_aaa7678f560359b32faa3d233e7788f3d}{HadamardDiv}}(dy,\ dx);}
\DoxyCodeLine{00058\ \ \ \textcolor{comment}{//for(size\_t\ i\ =\ 0;\ i\ <\ df.rows()\ -\/\ 1;\ ++i)\ \{\ df.SetRow(i,\ res.GetSlice(i,\ i,\ 0,\ res.columns()\ -\/\ 1));\ \}}}
\DoxyCodeLine{00059\ \ \ df.SetSlice(0,\ df.rows()\ -\/\ 2,\ 0,\ df.columns()\ -\/\ 1,\ res);}
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{return}\ df;}
\DoxyCodeLine{00061\ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00073\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\ \mbox{\hyperlink{Differentiation_8h_a0d1f10df297acbf012f59dbe025a4d85}{backwardDiff}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ y)\ \{}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{auto}\ df\ \ =\ \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00075\ \ \ \textcolor{keyword}{auto}\ dy\ \ =\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(1,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1)\ -\/\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 2,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00076\ \ \ \textcolor{keyword}{auto}\ dx\ \ =\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(1,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1)\ -\/\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 2,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00077\ \ \ \textcolor{keyword}{auto}\ res\ =\ \mbox{\hyperlink{matrix__utils_8h_aaa7678f560359b32faa3d233e7788f3d}{HadamardDiv}}(dy,\ dx);}
\DoxyCodeLine{00078\ \ \ df.SetSlice(1,\ df.rows()\ -\/\ 1,\ 0,\ df.columns()\ -\/\ 1,\ res);}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{return}\ df;}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00092\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\ \mbox{\hyperlink{Differentiation_8h_a491c1ed77a5dc36d6e7a2656a0c7a436}{centralDiff}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ y)\ \{}
\DoxyCodeLine{00093\ \ \ \textcolor{keyword}{auto}\ df\ \ =\ \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00094\ \ \ \textcolor{keyword}{auto}\ dy\ \ =\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(2,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1)\ -\/\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 3,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00095\ \ \ \textcolor{keyword}{auto}\ dx\ \ =\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(2,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1)\ -\/\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 3,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00096\ \ \ \textcolor{keyword}{auto}\ res\ =\ \mbox{\hyperlink{matrix__utils_8h_aaa7678f560359b32faa3d233e7788f3d}{HadamardDiv}}(dy,\ dx);}
\DoxyCodeLine{00097\ \ \ df.SetSlice(1,\ df.rows()\ -\/\ 2,\ 0,\ df.columns()\ -\/\ 1,\ res);}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordflow}{return}\ df;}
\DoxyCodeLine{00099\ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00110\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\ \mbox{\hyperlink{Differentiation_8h_ad0138b0a17dd2be7243b310c3cf5a1f1}{backwardDiff2}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ y)\ \{}
\DoxyCodeLine{00111\ \ \ \textcolor{keyword}{auto}\ df\ =\ \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00112\ \ \ \textcolor{keyword}{auto}\ dy\ =\ (3\ *\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(2,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1))}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ (4\ *\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(1,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 2,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1))\ +\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 3,\ 0,\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00114\ \ \ \textcolor{keyword}{auto}\ dx\ \ =\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(2,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1)\ -\/\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 3,\ 0,\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ -\/\ 1);}
\DoxyCodeLine{00115\ \ \ \textcolor{keyword}{auto}\ res\ =\ \mbox{\hyperlink{matrix__utils_8h_aaa7678f560359b32faa3d233e7788f3d}{HadamardDiv}}(dy,\ dx);}
\DoxyCodeLine{00116\ \ \ df.SetSlice(2,\ df.rows()\ -\/\ 1,\ 0,\ df.columns()\ -\/\ 1,\ res);}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{return}\ df;}
\DoxyCodeLine{00118\ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00129\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\ \mbox{\hyperlink{Differentiation_8h_a29c9f611b1a069da1d521c96b5d817fc}{centralDiff4}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ y)\ \{}
\DoxyCodeLine{00130\ \ \ \textcolor{keyword}{auto}\ df\ =\ \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(),\ x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{00131\ \ \ \textcolor{keyword}{auto}\ dy\ =\ (-\/1\ *\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(4,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1))\ +\ (8\ *\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(3,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 2))\ -\/\ (8\ *\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(1,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 4))}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ +\ y.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 5);}
\DoxyCodeLine{00133\ \ \ \textcolor{keyword}{auto}\ dx\ \ =\ 3.0\ *\ (x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(4,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 1)\ -\/\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0,\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ -\/\ 5));}
\DoxyCodeLine{00134\ \ \ \textcolor{keyword}{auto}\ res\ =\ \mbox{\hyperlink{matrix__utils_8h_aaa7678f560359b32faa3d233e7788f3d}{HadamardDiv}}(dy,\ dx);}
\DoxyCodeLine{00135\ \ \ df.SetSlice(2,\ df.rows()\ -\/\ 3,\ 0,\ df.columns()\ -\/\ 1,\ res);}
\DoxyCodeLine{00136\ \ \ \textcolor{keywordflow}{return}\ df;}
\DoxyCodeLine{00137\ \}}
\DoxyCodeLine{00138\ }

\end{DoxyCode}
