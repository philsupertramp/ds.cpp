\doxysection{KNN.\+h}
\hypertarget{KNN_8h_source}{}\label{KNN_8h_source}\index{include/math/ds/KNN.h@{include/math/ds/KNN.h}}
\mbox{\hyperlink{KNN_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Matrix_8h}{../Matrix.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{matrix__utils_8h}{../matrix\_utils.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{numerics_2utils_8h}{../numerics/utils.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Classifier_8h}{Classifier.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classKNN}{KNN}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classClassifier}{Classifier}}}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classKNN_a4b23e38827e4de329fa9a383f69655d5}{nearest\_neighbors}};}
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\ \mbox{\hyperlink{classKNN_a98edf87cb19959a95cfdbad5c8a02449}{trainLabels}};}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{classKNN_a21c02a5dbd28d9fb9e1a5daefd287a28}{KNN}}(\textcolor{keywordtype}{int}\ neighbors)}
\DoxyCodeLine{00037\ \ \ \ \ :\ \mbox{\hyperlink{classClassifier}{Classifier}}()}
\DoxyCodeLine{00038\ \ \ \ \ ,\ \mbox{\hyperlink{classKNN_a4b23e38827e4de329fa9a383f69655d5}{nearest\_neighbors}}(neighbors)\ \{\ \}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00049\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classKNN_ab5c83a7deee14bf6b66ecef806f77b41}{fit}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ X,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ y)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00050\ \ \ \ \ assert(y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()\ ==\ 1\ ||\ y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()\ ==\ 1);}
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{classClassifier_a5d4d61496164c06deab141329b6c878f}{weights}}\ \ \ \ \ =\ X;}
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{classKNN_a98edf87cb19959a95cfdbad5c8a02449}{trainLabels}}\ =\ y;}
\DoxyCodeLine{00053\ \ \ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\ \mbox{\hyperlink{classKNN_a8e9c1edbc9a7fc4756ef86fbe52bb753}{predict}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&\ x)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{auto}\ predictions\ =\ \mbox{\hyperlink{numerics_2utils_8h_ae4d3442586cdfc0c5468be49ff561bcd}{zerosV}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{auto}\ trainX\ \ \ \ \ \ =\ \mbox{\hyperlink{classClassifier_a5d4d61496164c06deab141329b6c878f}{weights}};}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{auto}\ trainY\ \ \ \ \ \ =\ \mbox{\hyperlink{classKNN_a98edf87cb19959a95cfdbad5c8a02449}{trainLabels}};}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keyword}{auto}\ labels\ \ \ \ \ \ =\ \mbox{\hyperlink{matrix__utils_8h_af79386365c3901ef0bec8f116368ded2}{unique}}(trainY);}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();\ ++i)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ xi\ \ \ \ \ \ \ \ \ \ \ \ =\ x.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(i);}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ current\_dists\ =\ \mbox{\hyperlink{numerics_2utils_8h_aa1a08a76ee49f8a9717e4aa127984987}{norm}}(trainX\ -\/\ xi,\ 0);}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ k\_neares\ \ \ \ \ \ =\ trainY.GetSlicesByIndex(\mbox{\hyperlink{numerics_2utils_8h_a3941c57711e2df110722731c03ceb7b5}{argsort}}(current\_dists));}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ k\_nearest\ \ \ \ \ =\ k\_neares.GetSlice(0,\ \mbox{\hyperlink{classKNN_a4b23e38827e4de329fa9a383f69655d5}{nearest\_neighbors}}\ -\/\ 1);}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ gamma\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(labels.rows(),\ 1);}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ k\ =\ 0;\ k\ <\ labels.rows();\ ++k)\ \{}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ std::function<bool(\textcolor{keywordtype}{double})>\ condition\ =\ [k](\textcolor{keywordtype}{double}\ x)\ \{\ \textcolor{keywordflow}{return}\ bool(x\ ==\ k);\ \};}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ O(N)}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ yis\ =\ \mbox{\hyperlink{matrix__utils_8h_afb3f7de2743f10b710460feb9c0f9009}{where}}(condition,\ k\_nearest,\ \{\ \{\ 1\ \}\ \},\ \{\ \{\ 0\ \}\ \});}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ O(N)}}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ gamma(k,\ 0)\ =\ yis.sumElements();}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ predictions(i,\ 0)\ =\ \mbox{\hyperlink{matrix__utils_8h_a2a01e8ac881ea58d279cd73ec1803444}{argmax}}(gamma);}
\DoxyCodeLine{00084\ \ \ \ \ \}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{return}\ predictions;}
\DoxyCodeLine{00086\ \ \ \};}
\DoxyCodeLine{00087\ \};}

\end{DoxyCode}
